(()=>{"use strict";var e,t=function(e=[],t=null){var n={};return n.tasks=JSON.parse(JSON.stringify(e)),n.taskStatus=null==t?new Array(e.length).fill(0):JSON.parse(JSON.stringify(t)),n.addTask=function(e){n.tasks.push(e),n.taskStatus.push(0)},n.completeTask=function(e){n.taskStatus[e]=1},n.removeTask=function(e){n.taskStatus.splice(e,1),n.tasks.splice(e,1)},n.show=function(){for(let e=0;e<n.tasks.length;e++)console.log(n.taskStatus[e]+" "+n.tasks[e])},n},n=function(e,t,n,i,s=!1,a=1){var d={};return d.title=e,d.description=t,d.dueDate=n,d.priority=a,d.checkList=i,d.isComplete=s,d},i=function(e,t=[]){var n={};return n.name=e,n.toDoLists=t,n.addToProject=function(e){n.toDoLists.push(e)},n.removeFromProject=function(e){n.toDoLists.splice(e,1)},n},s=function(e="anonymous"){var s={};return s.name=e,s.projects=[new i("default",[n("Getting started","have fun",JSON.stringify(new Date).slice(1,11),t(["item 1","item 2"])),n("Again getting started","have fun again",JSON.stringify(new Date).slice(1,11),t(["item 3","item 4"]))]),new i("default2",[n("Getting started2","have fun2",JSON.stringify(new Date).slice(1,11),t(["item 12","item 22"])),n("Again getting started2","have fun again2",JSON.stringify(new Date).slice(1,11),t(["item 32","item 42"]))])],s.createNewProject=function(e){tempProj=i(e),s.projects.push(tempProj)},s.removeProject=function(e){s.projects.splice(e,1)},s},a=e={pushUpdate:function(){localStorage.setItem("user",JSON.stringify(this.user))},user:"",initiatePage:function(){if(null==localStorage.getItem("user"))e.user=new s,e.pushUpdate();else{var a=JSON.parse(localStorage.user),d=new s(a.name);d.removeProject(0),d.removeProject(0),a.projects.forEach((e=>{var s=new i(e.name);e.toDoLists.forEach((e=>{s.addToProject(new n(e.title,e.description,e.dueDate,new t(e.checkList.tasks,e.checkList.taskStatus),e.isComplete))})),d.projects.push(s)})),e.user=d,e.pushUpdate()}}},d=function(e,t=null){var n=document.createElement("div");return n.className=e,null!=t&&(n.innerHTML=t),n},o=function(e,t,n=""){var i=document.createElement("input");return i.className=e,i.autofocus=!0,i.maxLength=t,i.placeholder=n,i},r=function(){var e,t=d("detailedTaskItem"),n=d("plus","+>"),i=o("titleInput",80,"Title"),s=function(e,t,n=""){var i=document.createElement("textarea");return i.className=e,i.autofocus=!0,i.maxLength=t,i.placeholder=n,i}("descriptionInput",200,"short description"),a=("duedateInput",(e=document.createElement("input")).className="duedateInput",e.type="date",e.min=JSON.stringify(new Date).slice(1,11),e),r=d("checklistInput"),l=function(e){var t=d("checklistinputitem"),n=d("tick2"),i=o("detail2",100,"add task");return t.appendChild(n),t.appendChild(i),e.appendChild(t),e};r=l(r);var c=d("saveTask","&#8629;");return t.appendChild(n),t.appendChild(i),t.appendChild(s),t.appendChild(a),t.appendChild(r),t.appendChild(c),n.onclick=e=>{l(e.srcElement.parentNode.childNodes[4])},t},l=function(){var e=document.getElementById(this.parentNode.id).childNodes[0],t=JSON.parse(this.parentNode.id);0==a.user.projects[t[0]].toDoLists[t[1]].isComplete?(e.innerHTML="&#10003;",a.user.projects[t[0]].toDoLists[t[1]].isComplete=!0):(e.innerHTML="&#9634;",a.user.projects[t[0]].toDoLists[t[1]].isComplete=!1),a.pushUpdate()},c=function(){var e=document.getElementById(this.id).childNodes[0],t=JSON.parse(this.id);0==a.user.projects[t[0]].toDoLists[t[1]].checkList.taskStatus[t[2]]?(e.innerHTML="&#10003;",a.user.projects[t[0]].toDoLists[t[1]].checkList.taskStatus[t[2]]=!0):(e.innerHTML="&#9634;",a.user.projects[t[0]].toDoLists[t[1]].checkList.taskStatus[t[2]]=!1),a.pushUpdate()},u=function(e){var t=a.user.projects[e],n=0,i=function(){p(JSON.parse(this.parentNode.id))},s=function(t){var n=JSON.parse(this.parentNode.id);document.getElementById(this.parentNode.id).remove(),a.user.projects[n[0]].toDoLists.splice(n[1],1),function(){for(var t=document.getElementById("taskList").firstElementChild,n=0;null!=t;)"plus"!=t.firstChild.firstChild.className&&(t.id=JSON.stringify([e,n++])),t=t.nextElementSibling}(),a.pushUpdate()};null!=t&&t.toDoLists.forEach((t=>{var a,o,r,c,u,p,h,m,f,N,k,v=(a=t.isComplete,o=t.title,r=t.description,c=t.dueDate.slice(0,10),u=d("tick",1==a?"&#10003;":"&#9634;"),p=d("title",o),h=d("description",r),m=d("duedate",c),f=d("delete","X"),(N=d("taskItem")).appendChild(u),N.appendChild(p),N.appendChild(h),N.appendChild(m),N.appendChild(f),N);v.childNodes[0].onclick=l,v.childNodes[1].onclick=i,v.childNodes[2].onclick=i,v.childNodes[3].onclick=i,v.childNodes[4].onclick=s,v.id=JSON.stringify([e,n++]),k=v,document.getElementById("taskList").appendChild(k)}))},p=function(e){document.getElementById("taskList").innerHTML="",u(e[0]);var i,s,o,p,h,m,f,N,k,v=document.getElementById(JSON.stringify(e)),g=(i=a.user.projects[e[0]].toDoLists[e[1]],s=1==i.isComplete?"&#10003;":"&#9634;",o=d("tick",s),p=d("title",i.title),h=d("description",i.description),m=d("duedate",i.dueDate.slice(0,10)),f=function(e){var t=d("checklist");for(let a=0;a<e.tasks.length;a++){var n=d("tick");n.innerHTML=0==e.taskStatus[a]?"&#9634;":"&#10003;";var i=d("detail");i.innerHTML=e.tasks[a];var s=d("checklistitem");s.appendChild(n),s.appendChild(i),t.appendChild(s)}return t}(i.checkList),N=d("detailedTaskItem"),k=d("editButton","edit"),N.appendChild(o),N.appendChild(p),N.appendChild(h),N.appendChild(m),N.appendChild(f),N.appendChild(k),N);g.id=v.id,g.childNodes[0].onclick=l,g.lastElementChild.onclick=i=>{var s=JSON.parse(i.srcElement.parentNode.id),d=r(),o=a.user.projects[s[0]].toDoLists[s[1]];d.childNodes[1].value=o.title,d.childNodes[2].value=o.description,d.childNodes[3].value=o.dueDate;for(let e=0;e<o.checkList.tasks.length;e++){const t=o.checkList.tasks[e];d.childNodes[4].firstElementChild.lastElementChild.value=t}var l=document.getElementById("taskList");d.childNodes[5].onclick=i=>{!function(i){var s=[];i[4].childNodes.forEach((e=>{s.push(e.childNodes[1].value)}));var d=n(i[1].value,i[2].value,i[3].value,t(s));a.user.projects[e[0]].toDoLists.splice(e[1],1),a.user.projects[e[0]].toDoLists.push(d),document.getElementById("taskList").innerHTML="",u(e[0]),a.pushUpdate()}(i.srcElement.parentNode.childNodes)},l.replaceChild(d,document.getElementById(JSON.stringify(e)))};var L=0;g.childNodes[4].childNodes.forEach((t=>{t.id=JSON.stringify([e[0],e[1],L++]),t.onclick=c})),v.parentNode.replaceChild(g,v)},h=function(e){var s=a.user.projects,l=0,c=e=>{var t=document.getElementsByClassName("name");for(let n=0;n<t.length;n++)t[n].style.backgroundColor=n==e?"blue":"brown"},p=e=>{var t=JSON.parse(e.srcElement.parentNode.id);c(t[0]),document.getElementById("taskList").innerHTML="",document.getElementById("list").innerHTML="",h(t[0])},m=function(){var e=JSON.parse(this.parentNode.id);a.user.projects.splice([e[0]],1),a.pushUpdate(),document.getElementById("taskList").innerHTML="",document.getElementById("list").innerHTML="",f()};document.getElementById("projButton").onclick=()=>{var e,t,n,s=document.getElementById("list"),r=(e=o("projInput",20),t=d("projSave","&#8629;"),(n=d("projectItem")).appendChild(e),n.appendChild(t),n);if(r.childNodes[1].onclick=function(e){var t=i(e.srcElement.parentNode.childNodes[0].value);a.user.projects.push(t),document.getElementById("list").innerHTML="",document.getElementById("taskList").innerHTML="",h(0),a.pushUpdate()},0==s.childElementCount)s.appendChild(r);else{var l=document.getElementsByClassName("projectItem");"projInput"!=l[0].childNodes[0].className&&s.insertBefore(r,l[0])}},document.getElementById("button").onclick=()=>{var i=document.getElementById("taskList"),s=r();if(s.childNodes[5].onclick=i=>{!function(i){var s=[];i[4].childNodes.forEach((e=>{s.push(e.childNodes[1].value)}));var d=n(i[1].value,i[2].value,i[3].value,t(s));a.user.projects[e].toDoLists.push(d),document.getElementById("taskList").innerHTML="",u(e),a.pushUpdate()}(i.srcElement.parentNode.childNodes)},0==i.childElementCount)i.appendChild(s);else{var d=JSON.parse(i.lastElementChild.id);i.innerHTML="",u(d[0]);var o=i.firstElementChild;"tick"==o.childNodes[0].className&&i.insertBefore(s,o)}},s.forEach((e=>{var t=function(e){var t=d("name",e),n=d("del",e);n.innerHTML="x",t.innerHTML=e;var i=d("projectItem");return i.appendChild(t),i.appendChild(n),i}(e.name);t.id=JSON.stringify([l++]),document.getElementById("list").appendChild(t),t.childNodes[0].onclick=p,t.childNodes[1].onclick=m})),c(e),u(e)},m=function(){var e=document.getElementById("username"),t=function(){var e=o("name",20,"enter name"),t=d("ok","&#10009;"),n=d("username");return n.appendChild(e),n.appendChild(t),n}();t.id="username",t.childNodes[1].onclick=()=>{a.user.name=t.childNodes[0].value,a.pushUpdate(),location.reload()},e.parentElement.replaceChild(t,e)},f=function(){a.initiatePage();var e=document.getElementById("username");e.innerHTML=a.user.name,e.onclick=m,h(0)};f()})();